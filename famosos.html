<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mais Vendidos - Init Store</title>
  <link rel="icon" type="image/x-icon" href="icon.png">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <style>
    .swiper { width: 100%; padding: 40px 0; }
    .swiper-slide { display: flex; justify-content: center; }
    .notebook { width: 300px !important; }
    .swiper-pagination-bullet-active { background: #173f5f; }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="cabecalho">
        <h1>Init Store</h1>
        <nav class="menu">
          <ul>
            <a href="index.html">Início</a>
            <a href="produtos.html">Produtos</a>
            <select id="select-categorias" onchange="redirecionarCategoria(this.value)">
              <option value="">Categorias</option>
            </select>                    
            <a href="famosos.html">Mais Vendidos</a>
          </ul>
        </nav>
        <form action="buscar.html" method="get">
          <input type="text" name="q" placeholder="Buscar Produto..." required>
        </form>
        <nav class="carrinho">
          <a href="carrinho.html">
            <img src="carrinho.png" alt="Carrinho" style="width: 30px;">
            <span id="contador-carrinho" class="badge">0</span>
          </a>
        </nav>
        <nav class="conta">
          <a href="conta.html">
            <img src="user.png" alt="Conta" style="width: 30px;">
          </a>
        </nav>
      </div>
    </div>
  </header>

  <main class="container">
    <h2 style="margin: 40px 0 20px; font-size: 2.2em; color: #173f5f; text-align: center;">
      Mais Vendidos da Init Store
    </h2>
    <p style="text-align: center; color: #666; margin-bottom: 40px;">
      Os produtos que todo mundo está levando!
    </p>

    <div class="swiper">
      <div class="swiper-wrapper" id="famosos-lista">
        <div class="swiper-slide"><p>Carregando os mais vendidos...</p></div>
      </div>
      <div class="swiper-pagination"></div>
    </div>
  </main>

  <footer>
    <div class="container">
      <div class="rodape">
        <div class="contatos">
          <h4>Entre em Contato</h4>
          <p>Email: initstore@gmail.com</p>
        </div>
        <div class="direitos">
          <p>© 2025 Igor Epping. Todos os direitos reservados.</p>
        </div>
      </div>
    </div>
  </footer>

  <script src="script.js"></script>
  <script>
    async function carregarFamosos() {
      const lista = document.getElementById('famosos-lista');
      try {
        const res = await fetch('famosos.php');
        const data = await res.json();
        if (!data.dados || data.dados.length === 0) {
          lista.innerHTML = '<div class="swiper-slide"><p>Nenhum produto em destaque no momento.</p></div>';
          return;
        }

        lista.innerHTML = data.dados.map(p => `
          <div class="swiper-slide">
            <div class="notebook">
              <div class="card-image">
                <img src="${p.imagem_url}" alt="${p.nome}" onerror="this.src='https://placehold.co/300x200?text=Sem+Imagem'">
              </div>
              <div class="card-content">
                <h2 class="product-title">${p.nome}</h2>
                <p class="product-price">R$ ${parseFloat(p.preco).toFixed(2).replace('.', ',')}</p>
                <button class="add-to-cart-btn" onclick="adicionarAoCarrinho(${p.id})">
                  Adicionar ao Carrinho
                </button>
              </div>
            </div>
          </div>
        `).join('');

        new Swiper('.swiper', {
          loop: true,
          autoplay: { delay: 4000 },
          pagination: { el: '.swiper-pagination', clickable: true },
          breakpoints: {
            640: { slidesPerView: 1 },
            768: { slidesPerView: 2 },
            1024: { slidesPerView: 3 },
            1200: { slidesPerView: 4 }
          }
        });

      } catch (err) {
        lista.innerHTML = '<div class="swiper-slide"><p style="color:red;">Erro ao carregar produtos.</p></div>';
      }
    }

    document.addEventListener('DOMContentLoaded', carregarFamosos);
  </script>
</body>
</html>